<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@thi.ng/rstream](./rstream.md) &gt; [metaStream](./rstream.metastream.md)

## metaStream variable

Returns a [Subscription](./rstream.subscription.md) which transforms each incoming value into a new [Stream](./rstream.stream.md)<!-- -->, subscribes to it (via an hidden / internal subscription) and then only passes values from that stream to its own subscribers.

<b>Signature:</b>

```typescript
metaStream: <A, B>(factory: Fn<A, Subscription<B, B>>, opts?: Partial<CommonOpts> | undefined) => MetaStream<A, B>
```

## Remarks

If a new value is received, the metastream first unsubscribes from any still active stream, before creating and subscribing to the new stream. Hence this stream type is useful for cases where streams need to be dynamically created &amp; inserted into an existing dataflow topology.

The user supplied `factory` function will be called for each incoming value and is responsible for creating the new stream instances. If the function returns null/undefined, no further action will be taken (acts like a filter transducer).

The factory function does NOT need to create \*new\* streams, but can merely return other existing streams, and so making the meta stream act like a switch with arbitrary criteria.

If the meta stream itself is the only subscriber to existing input streams, you'll need to configure the input's [CommonOpts.closeOut](./rstream.commonopts.closeout.md) option to keep them alive and support dynamic switching between them.

## Example 1


```ts
// transform each received odd number into a stream
// producing 3 copies of that number in the metastream
// even numbers are ignored
a = metastream(
  (x) => (x & 1)
    ? fromIterable(tx.repeat(x, 3), { delay: 100 })
    : null
);

a.subscribe(trace())
a.next(23)

// 23
// 23
// 23

a.next(42) // ignored by factory fn

a.next(43)
// 43
// 43
// 43

```

## Example 2


```ts
// infinite inputs
a = fromIterable(
  tx.repeat("a"),
  { delay: 1000, closeOut: CloseMode.NEVER }
);
b = fromIterable(
  tx.repeat("b"),
  { delay: 1000, closeOut: CloseMode.NEVER }
);

// stream selector / switch
m = metaStream((x) => x ? a : b);
m.subscribe(trace("meta from: "));

m.next(true);
// meta from: a

m.next(false);
// meta from: b

m.next(true);
// meta from: a

```

