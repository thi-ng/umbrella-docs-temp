<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@thi.ng/interceptors](./interceptors.md) &gt; [StatelessEventBus](./interceptors.statelesseventbus.md)

## StatelessEventBus class

Batched event processor for using composable interceptors for event handling and side effects to execute the result of handled events.

<b>Signature:</b>

```typescript
export declare class StatelessEventBus implements IDispatch 
```

## Remarks

Events processed by this class are simple 2-element tuples/arrays of this form: `["event-id", payload?]`<!-- -->, where the `payload` is optional and can be of any type.

Events are processed by registered handlers which transform each event into a number of side effect descriptions to be executed later. This separation ensures event handlers themselves are pure functions and leads to more efficient reuse of side effecting operations. The pure data nature until the last stage of processing (the application side effects) too means that event flow can be much easier inspected and debugged.

In this model a single event handler itself is an array of objects with `pre` and/or `post` keys and functions attached to each key. These functions are called interceptors, since each intercepts the processing of an event and can contribute their own side effects. Each event's interceptor chain is processed bi-directionally (`pre` in forward, `post` in reverse order) and the effects returned from each interceptor are merged/collected. The outcome of this setup is a more aspect-oriented, composable approach to event handling and allows to inject common, re-usable behaviors for multiple event types (logging, validation, undo/redo triggers etc.).

Side effects are only processed after all event handlers have run. Furthermore, their order of execution can be configured with optional priorities.

See for further details:

- [StatelessEventBus.processQueue()](./interceptors.statelesseventbus.processqueue.md) - [StatelessEventBus.processEvent()](./interceptors.statelesseventbus.processevent.md) - [StatelessEventBus.processEffects()](./interceptors.statelesseventbus.processeffects.md) - [StatelessEventBus.mergeEffects()](./interceptors.statelesseventbus.mergeeffects.md)

The overall approach of this type of event processing is heavily based on the pattern initially pioneered by @<!-- -->Day8/re-frame, with the following differences:

- stateless (see [EventBus](./interceptors.eventbus.md) for the more common stateful alternative) - standalone implementation (no assumptions about surrounding context/framework) - manual control over event queue processing - supports event cancellation (via FX\_CANCEL side effect) - side effect collection (multiple side effects for same effect type per frame) - side effect priorities (to control execution order) - dynamic addition/removal of handlers &amp; effects

## Constructors

|  Constructor | Modifiers | Description |
|  --- | --- | --- |
|  [(constructor)(handlers, effects)](./interceptors.statelesseventbus._constructor_.md) |  | Creates a new event bus instance with given handler and effect definitions (all optional). |

## Properties

|  Property | Modifiers | Type | Description |
|  --- | --- | --- | --- |
|  [currCtx](./interceptors.statelesseventbus.currctx.md) |  | <code>InterceptorContext &#124; undefined</code> |  |
|  [currQueue](./interceptors.statelesseventbus.currqueue.md) |  | <code>Event[] &#124; undefined</code> |  |
|  [effects](./interceptors.statelesseventbus.effects.md) |  | <code>IObjectOf&lt;SideEffect&gt;</code> |  |
|  [eventQueue](./interceptors.statelesseventbus.eventqueue.md) |  | <code>Event[]</code> |  |
|  [handlers](./interceptors.statelesseventbus.handlers.md) |  | <code>IObjectOf&lt;Interceptor[]&gt;</code> |  |
|  [priorities](./interceptors.statelesseventbus.priorities.md) |  | <code>EffectPriority[]</code> |  |
|  [state](./interceptors.statelesseventbus.state.md) |  | <code>any</code> |  |

## Methods

|  Method | Modifiers | Description |
|  --- | --- | --- |
|  [addBuiltIns()](./interceptors.statelesseventbus.addbuiltins.md) |  | Adds built-in event &amp; side effect handlers. |
|  [addEffect(id, fx, priority)](./interceptors.statelesseventbus.addeffect.md) |  |  |
|  [addEffects(specs)](./interceptors.statelesseventbus.addeffects.md) |  |  |
|  [addHandler(id, spec)](./interceptors.statelesseventbus.addhandler.md) |  |  |
|  [addHandlers(specs)](./interceptors.statelesseventbus.addhandlers.md) |  |  |
|  [context()](./interceptors.statelesseventbus.context.md) |  | If called during event processing, returns current side effect accumulator / interceptor context. Otherwise returns nothing. |
|  [dispatch(e)](./interceptors.statelesseventbus.dispatch.md) |  | Adds given events to event queue to be processed by [StatelessEventBus.processQueue()](./interceptors.statelesseventbus.processqueue.md) later on. |
|  [dispatchLater(e, delay)](./interceptors.statelesseventbus.dispatchlater.md) |  | Dispatches given event after <code>delay</code> milliseconds (by default 17). |
|  [dispatchNow(e)](./interceptors.statelesseventbus.dispatchnow.md) |  | Adds given events to whatever is the current event queue. If triggered via the <code>FX_DISPATCH_NOW</code> side effect from an event handler / interceptor, the event will still be executed in the currently active batch / frame. If called from elsewhere, the result is the same as calling [dispatch](./interceptors.dispatch.md)<!-- -->. |
|  [instrumentWith(inject, ids)](./interceptors.statelesseventbus.instrumentwith.md) |  | Prepends given interceptors (or interceptor functions) to selected handlers. If no handler IDs are given, applies instrumentation to all currently registered handlers. |
|  [interceptorsFromSpec(spec)](./interceptors.statelesseventbus.interceptorsfromspec.md) |  |  |
|  [mergeEffects(ctx, ret)](./interceptors.statelesseventbus.mergeeffects.md) |  | Merges the new side effects returned from an interceptor into the internal effect accumulator. |
|  [processEffect(ctx, effects, id, val)](./interceptors.statelesseventbus.processeffect.md) |  |  |
|  [processEffects(ctx)](./interceptors.statelesseventbus.processeffects.md) |  | Takes a collection of side effects generated during event processing and applies them in order of configured priorities. |
|  [processEvent(ctx, e)](./interceptors.statelesseventbus.processevent.md) |  | Processes a single event using its configured handler/interceptor chain. Logs warning message and skips processing if no handler is available for the event type. |
|  [processForward(ctx, iceps, e)](./interceptors.statelesseventbus.processforward.md) |  |  |
|  [processQueue(ctx)](./interceptors.statelesseventbus.processqueue.md) |  | Triggers processing of current event queue and returns <code>true</code> if any events have been processed. |
|  [processReverse(ctx, iceps, e)](./interceptors.statelesseventbus.processreverse.md) |  |  |
|  [removeEffect(id)](./interceptors.statelesseventbus.removeeffect.md) |  |  |
|  [removeEffects(ids)](./interceptors.statelesseventbus.removeeffects.md) |  |  |
|  [removeHandler(id)](./interceptors.statelesseventbus.removehandler.md) |  |  |
|  [removeHandlers(ids)](./interceptors.statelesseventbus.removehandlers.md) |  |  |

